@model AMS.Models.AccountViewModels.ForgotPasswordViewModel
@{
    ViewData["Title"] = "Forgot Password";
}

<div class="meta-auth-container">
    <div class="meta-auth-card forgot-password-card">
        <!-- Logo Section -->
        <div class="auth-logo">
            <img src="~/images/29logo.png" alt="29 Logo" />
        </div>

        <!-- Header -->
        <div class="auth-header">
            <h1>Forgot Password?</h1>
            <p>Enter your email to reset your password</p>
        </div>

        <!-- Forgot Password Form -->
        <form id="frmForgotPassword" class="meta-auth-form">
            <div class="form-group-meta">
                <label>Email Address</label>
                <input asp-for="Email" type="email" class="meta-input" placeholder="Enter your email" />
                <span asp-validation-for="Email" class="error-text"></span>
            </div>

            <button type="button" id="btnForgotPassword" onclick="ForgotPassword()" class="meta-btn-primary">
                Reset Password
            </button>
        </form>

        <!-- Footer Links -->
        <div class="auth-footer">
            <p>Remember your password? <a href="/Account/Login">Sign in</a></p>
            <p>Don't have an account? <a href="/Account/Register">Sign up</a></p>
        </div>
    </div>
</div>

<style>
/* Meta-Inspired Auth Container */
.meta-auth-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f0f2f5;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

.meta-auth-card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), 0 8px 16px rgba(0, 0, 0, 0.1);
    padding: 40px;
    width: 100%;
    max-width: 450px;
}

.forgot-password-card {
    max-width: 400px;
}

.auth-logo {
    text-align: center;
    margin-bottom: 20px;
}

.auth-logo img {
    width: 80px;
    height: auto;
}

.auth-header {
    text-align: center;
    margin-bottom: 32px;
}

.auth-header h1 {
    font-size: 24px;
    font-weight: 700;
    color: #1c1e21;
    margin: 0 0 8px 0;
}

.auth-header p {
    font-size: 15px;
    color: #65676b;
    margin: 0;
}

.meta-auth-form {
    margin-bottom: 24px;
}

.form-group-meta {
    margin-bottom: 16px;
}

.form-group-meta label {
    display: block;
    font-size: 14px;
    font-weight: 500;
    color: #1c1e21;
    margin-bottom: 6px;
}

.meta-input {
    width: 100%;
    padding: 12px 14px;
    font-size: 15px;
    border: 1px solid #dddfe2;
    border-radius: 6px;
    background: white;
    color: #1c1e21;
    transition: all 0.2s ease;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    box-sizing: border-box;
}

.meta-input:focus {
    outline: none;
    border-color: #0866FF;
    box-shadow: 0 0 0 2px rgba(8, 102, 255, 0.1);
}

.meta-input::placeholder {
    color: #8a8d91;
}

.error-text {
    display: block;
    font-size: 13px;
    color: #e41e3f;
    margin-top: 4px;
}

.meta-btn-primary {
    width: 100%;
    padding: 14px;
    font-size: 16px;
    font-weight: 600;
    color: white;
    background: #0866FF;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-top: 8px;
}

.meta-btn-primary:hover {
    background: #0552CC;
}

.meta-btn-primary:active {
    transform: scale(0.98);
}

.meta-btn-primary:disabled {
    background: #e4e6eb;
    color: #8a8d91;
    cursor: not-allowed;
}

.auth-footer {
    text-align: center;
    padding-top: 24px;
    border-top: 1px solid #e4e6eb;
}

.auth-footer p {
    font-size: 14px;
    color: #65676b;
    margin: 0 0 8px 0;
}

.auth-footer p:last-child {
    margin-bottom: 0;
}

.auth-footer a {
    color: #0866FF;
    text-decoration: none;
    font-weight: 500;
}

.auth-footer a:hover {
    text-decoration: underline;
}

@@media (max-width: 768px) {
    .meta-auth-card {
        padding: 24px;
    }
}
</style>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}

<script>
    var ForgotPassword = function () {
        if (!$("#frmForgotPassword").valid()) {
            return;
        }

        var _frmForgotPassword = $("#frmForgotPassword").serialize();
        $("#btnForgotPassword").prop("disabled", true);
        $("#btnForgotPassword").text("Please Wait...");

        $("#btnForgotPassword").LoadingOverlay("show", {
            background: "rgba(165, 190, 100, 0.5)"
        });
        $("#btnForgotPassword").LoadingOverlay("show");

        $.ajax({
            type: "POST",
            url: "/Account/ForgotPassword",
            data: _frmForgotPassword,
            success: function (result) {
                $("#btnForgotPassword").LoadingOverlay("hide", true);
                $('#btnForgotPassword').removeAttr('disabled');
                $("#btnForgotPassword").text("Reset Password");
                if (result.IsSuccess) {
                    location.href = "/Account/ForgotPasswordConfirmation";
                }
                else {
                    Swal.fire({
                        title: result.AlertMessage,
                        icon: "warning"
                    }).then(function () {
                        setTimeout(function () {
                            $('#Email').focus();
                        }, 400);
                    });
                }
            },
            error: function (errormessage) {
                $("#btnForgotPassword").LoadingOverlay("hide", true);
                $("#btnForgotPassword").text("Reset Password");
                $('#btnForgotPassword').removeAttr('disabled');
                Swal.fire({
                    html: '<pre>' + errormessage.responseText + '</pre>',
                    customClass: "swal-wide"
                });
            }
        });
    }
</script>
